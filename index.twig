<!DOCTYPE html>
<html class="{{ get_template_mode(false) }}" dir="{{ get_template_dir() }}" lang="{{ App.getLocale() }}">

<head>
    {{ View.fireHook('frontend.head_start') }}

    {% set title = block('title') is defined ? block('title') : Lang.get('general.support_portal')|e %}
    <title>{{ company }} - {{ title|raw }}</title>

    {% block meta %}{% endblock %}
    <meta property="og:title" content="{{ title|raw }}" />
    <meta property="og:image" content="{{ get_logo() }}" />

    {% include 'frontend.' ~ template ~ '.head_common' %}

    {% block scripts_header %}{% endblock %}

    {% set route = Route.currentRouteName() %}

    {{ View.fireHook('frontend.head') }}
    {{ View.fireHook('frontend.head_end') }}
</head>

<body class="sp-bg-secondary sp-text-primary print:sp-bg-primary">

    {{ View.fireHook('frontend.body_start') }}

    <header class="sp-sticky sp-top-0 sp-z-10002 sp-px-4 sm:sp-px-6 lg:sp-px-8 print:sp-static print:sp-px-0 print:sp-shadow-none
                   {% if not (route starts with 'core.frontend.home') or not show_search %}sp-shadow{% endif %}">
        <div class="sp-container sp-relative sp-py-0 sp-m-auto print:sp-max-w-full" style="max-width: 1280px;">
            {{ View.fireHook('frontend.header_start') }}

            {% if show_search %}
            <div class="sp-search sp-absolute sp-hidden sp-flex sp-items-center sp-h-full sp-w-full sp--mt-2
                        sp-bg-primary sp-z-10 print:sp-hidden">
                <div class="sp-grow sp-w-full">
                    <form name="search" action="{{ route('core.frontend.search') }}" method="get">
                        <input type="search" name="query" placeholder="{{ Lang.get('general.search') }}" />
                    </form>
                </div>
                <div class="sp-flex-none">
                    <div class="sp-search-close sp-button sp-ms-3" title="{{ Lang.get('general.close') }}">
                        <i class="fas fa-times"></i>
                    </div>
                </div>
            </div>
            {% endif %}

            <div class="sp-flex sp-items-center" style="height: 80px;">
                <div class="sp-grow">
                    <a href="{{ route('core.frontend.home') }}" class="sp-flex sp-items-center" style="gap: 0.75rem;">
                        {% if Config.get('settings.favicon') is not empty %}
                            <img src="{{ Config.get('settings.favicon') }}" alt="{{ company }}" class="sp-logo" style="width: 40px; height: 40px;" />
                        {% else %}
                            <img src="{{ get_logo(false) }}" alt="{{ company }}" class="sp-logo sp-inline dark:sp-hidden print:sp-inline" style="width: 40px; height: 40px;" />
                            <img src="{{ get_logo(true) }}" alt="{{ company }}" class="sp-logo sp-hidden dark:sp-inline print:sp-hidden" style="width: 40px; height: 40px;" />
                        {% endif %}
                        <span style="font-size: 1.25rem; font-weight: 700; color: white;">SessionCommander</span>
                    </a>
                </div>

                <div class="sp-flex-none print:sp-hidden sp-hidden lg:sp-flex sp-items-center" style="gap: 2rem;">
                    {% if not (route starts with 'core.frontend.home') and show_search %}
                        <a class="sp-search-button" style="padding: 0.5rem; color: var(--gray-300);">
                            <i class="fas fa-search"></i>
                        </a>
                    {% endif %}

                    {% if Config.get('settings.website_url') is not empty %}
                        <a href="{{ Config.get('settings.website_url') }}" style="color: var(--gray-300); text-decoration: none; transition: color 0.2s;">
                            {{ Lang.get('core.back_to_website') }}
                        </a>
                    {% endif %}

                    {% if auth_check() %}
                        <div class="sp-dropdown-container sp-relative sp-ms-1">
                            <a class="sp-action" style="color: var(--gray-300); text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                                <img class="sp-avatar sp-max-w-sm sp-shadow" src="{{ auth_user().avatar_url }}" style="width: 32px; height: 32px; border-radius: 50%;" />&nbsp;
                                {{ auth_user().formatted_name }}
                                <i class="fas fa-chevron-down sp-ms-1 sp-text-xs" aria-hidden="true"></i>
                            </a>
                            <div class="sp-dropdown sp-end-0 sp-mt-2">
                                {% include 'frontend.' ~ template ~ '.navigation' with {'account': true} %}
                            </div>
                        </div>
                    {% else %}
                        <a href="{{ route('user.login') }}" class="bg-purple-gradient">
                            {{ Lang.get('user.login') }}
                        </a>
                    {% endif %}
                </div>

                <div class="sp-flex-none sp-leading-0 lg:sp-hidden print:sp-hidden">
                    <div class="sp-mobile-nav-button sp-inline-block">
                        <div class="sp-px-3/2 sp-py-1 sp-rounded sp-border sp-cursor-pointer" style="color: var(--gray-300);">
                            <svg focusable="false" viewBox="0 0 24 24" style="width: 24px; height: 24px;">
                                <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            {% block header %}{% endblock %}

            {{ View.fireHook('frontend.header_end') }}
        </div>
    </header>

    <nav class="sp-mobile-nav sp-hidden sp-fixed sp-w-full sp-top-0 sp-px-4 sm:sp-px-6 sp-bg-primary-800 sp-shadow-inner
                sp-text-white sp-overflow-y-auto sp-z-10001 lg:sp-hidden print:sp-hidden" style="background-color: var(--gray-950); border-top: 1px solid rgba(168, 85, 247, 0.2);">
        <div class="sp-container sp-py-6 sp-m-auto">
            {% include 'frontend.' ~ template ~ '.navigation' %}
        </div>
    </nav>

    {% block precontent %}{% endblock %}

    <div class="sp-relative xs:sp-px-6 lg:sp-static lg:sp-px-8 print:sp-px-0">
        <div class="sp-container sp-mx-auto sp-my-4 xs:sp-my-6 lg:sp-my-8 print:sp-max-w-full" style="max-width: 1280px;">

            {{ View.fireHook('frontend.wrapper_start') }}

            <div class="sp-px-6 sp-mb-4 sp-leading-none xs:sp-px-0 xs:sp-mb-6 lg:sp-mb-8">
                <h1 class="sp-hidden md:sp-block sp-mb-3 sp-text-3xl sp-font-normal print:sp-block">
                    {{ title|raw }}
                </h1>

                <div class="sp-breadcrumb md:sp-text-sm print:sp-mb-6">
                    <a href="{{ route('core.frontend.home') }}">{{ Lang.get('general.support_portal') }}</a> &nbsp;&raquo;&nbsp;
                    {% block breadcrumb %}{% endblock %}
                </div>

                <hr class="sp-hidden sp-mx-0 print:sp-block" />
            </div>

            <div class="sp-flex sp-flex-wrap-reverse sp-min-w-0 lg:sp-flex-nowrap">

                <div class="sp-content sp-grow sp-w-full sp-overflow-hidden lg:sp-w-auto">

                    {{ View.fireHook('frontend.content_start') }}

                    <div class="sp-content-inner sp-p-6 sp-bg-primary sp-break-words xs:sp-rounded print:sp-p-0">

                        {{ View.fireHook('frontend.content_inner_start') }}

                        {% block subtitle %}{% endblock %}

                        <!-- Box to display success/error messages generated by JavaScript -->
                        <div class="sp-alert sp-hidden" id="js-message-box"></div>

                        {% if Session.has('success') %}
                            <div class="sp-alert sp-alert-success">{{ Session.get('success')|raw }}</div>
                        {% elseif Session.has('error') %}
                            <div class="sp-alert sp-alert-error">{{ Session.get('error')|raw }}</div>
                        {% elseif Session.has('warning') %}
                            <div class="sp-alert sp-alert-warning">{{ Session.get('warning')|raw }}</div>
                        {% endif %}

                        {% if errors|default is not empty and errors.count() %}
                            <div class="sp-alert sp-alert-error">
                                <strong>{{ Lang.get('messages.please_correct') }}</strong><br />
                                {% for error in errors.all() %}
                                    {{ error }}<br />
                                {% endfor %}
                            </div>
                        {% endif %}

                        {% block content %}{% endblock %}

                        {{ View.fireHook('frontend.content_inner_end') }}

                    </div>

                    {{ View.fireHook('frontend.content_end') }}

                </div>

                {% block sidebar %}{% endblock %}

                {{ View.fireHook('frontend.wrapper_end') }}
            </div>

        </div>
    </div>

    <footer class="sp-px-4 sm:sp-px-6 lg:sp-px-8 sp-mt-12 sp-border-t sp-border-tertiary print:sp-px-0" style="background-color: var(--gray-900); border-top: 1px solid rgba(168, 85, 247, 0.2);">
        <div class="sp-container sp-py-12 sp-mx-auto print:sp-max-w-full" style="max-width: 1280px;">
            <div class="sp-grid sp-grid-cols-1 md:sp-grid-cols-4 sp-gap-8" style="display: grid; grid-template-columns: repeat(1, minmax(0, 1fr)); gap: 2rem;">
                <!-- Brand -->
                <div class="sp-col-span-1 md:sp-col-span-2">
                    <a href="{{ route('core.frontend.home') }}" class="sp-flex sp-items-center" style="gap: 0.75rem; margin-bottom: 1rem; text-decoration: none;">
                        {% if Config.get('settings.favicon') is not empty %}
                            <img src="{{ Config.get('settings.favicon') }}" alt="{{ company }}" style="width: 40px; height: 40px;" />
                        {% else %}
                            <img src="{{ get_logo(false) }}" alt="{{ company }}" class="sp-inline dark:sp-hidden" style="width: 40px; height: 40px;" />
                            <img src="{{ get_logo(true) }}" alt="{{ company }}" class="sp-hidden dark:sp-inline" style="width: 40px; height: 40px;" />
                        {% endif %}
                        <span style="font-size: 1.25rem; font-weight: 700; color: white;">SessionCommander</span>
                    </a>
                    <p style="color: var(--gray-400); font-size: 0.875rem; max-width: 28rem; margin: 0;">
                        Recording session management designed exclusively for classical music professionals.
                    </p>
                </div>

                <!-- Quick Links -->
                <div>
                    <h3 style="color: white; font-weight: 600; margin-bottom: 1rem; font-size: 1rem;">Quick Links</h3>
                    <ul style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 0.5rem;">
                        {% if Config.get('settings.website_url') is not empty %}
                            <li>
                                <a href="{{ Config.get('settings.website_url') }}/features" style="color: var(--gray-400); text-decoration: none; font-size: 0.875rem; transition: color 0.2s;">
                                    Features
                                </a>
                            </li>
                            <li>
                                <a href="{{ Config.get('settings.website_url') }}/pricing" style="color: var(--gray-400); text-decoration: none; font-size: 0.875rem; transition: color 0.2s;">
                                    Pricing
                                </a>
                            </li>
                            <li>
                                <a href="{{ Config.get('settings.website_url') }}/about" style="color: var(--gray-400); text-decoration: none; font-size: 0.875rem; transition: color 0.2s;">
                                    About
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                </div>

                <!-- Resources -->
                <div>
                    <h3 style="color: white; font-weight: 600; margin-bottom: 1rem; font-size: 1rem;">Resources</h3>
                    <ul style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 0.5rem;">
                        <li>
                            <a href="{{ route('core.frontend.home') }}" style="color: var(--gray-400); text-decoration: none; font-size: 0.875rem; transition: color 0.2s;">
                                Support
                            </a>
                        </li>
                        {% if Config.get('settings.website_url') is not empty %}
                            <li>
                                <a href="{{ Config.get('settings.website_url') }}/community" style="color: var(--gray-400); text-decoration: none; font-size: 0.875rem; transition: color 0.2s;">
                                    Community Forum
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
            </div>

            <div class="sp-mt-8 sp-pt-8 sp-border-t" style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--gray-800); display: flex; flex-direction: column; gap: 1rem; align-items: center; justify-content: space-between;">
                <p style="color: var(--gray-500); font-size: 0.875rem; margin: 0;">
                    &copy; {{ "now"|date("Y") }} SessionCommander. All rights reserved.
                </p>
                <div style="display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center; align-items: center;">
                    {% if Config.get('settings.website_url') is not empty %}
                        <a href="{{ Config.get('settings.website_url') }}/privacy" style="color: var(--gray-500); text-decoration: none; font-size: 0.875rem; transition: color 0.2s;">
                            Privacy Policy
                        </a>
                        <a href="{{ Config.get('settings.website_url') }}/terms" style="color: var(--gray-500); text-decoration: none; font-size: 0.875rem; transition: color 0.2s;">
                            Terms of Service
                        </a>
                    {% endif %}
                    {% if Config.get('settings.language_frontend_toggle') == 1 %}
                        <div class="sp-flex-none print:sp-hidden" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-language" title="{{ Lang.choice('general.language', 1) }}" style="color: var(--gray-500);"></i>
                            <select name="language" style="background-color: var(--gray-800); color: var(--gray-300); border: 1px solid var(--gray-700); border-radius: 0.375rem; padding: 0.25rem 0.5rem; font-size: 0.875rem;">
                                {% for code, language in languages %}
                                    <option value="{{ code }}"
                                            {% if code == App.getLocale() %}selected="selected"{% endif %}
                                            {% if attribute(returnTo, code) is defined %}data-return-to="{{ attribute(returnTo, code) }}"{% endif %}>
                                        {{ language }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </footer>

    {{ View.fireHook('frontend.footer') }}

    {% include 'frontend.' ~ template ~ '.footer_common' %}

    <script src="{{ asset_rev('resources/assets/frontend/js/main.js')}}"></script>

    {% block scripts_footer %}{% endblock %}

    {{ View.fireHook('frontend.body_end') }}

</body>

</html>
